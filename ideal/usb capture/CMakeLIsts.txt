cmake_minimum_required(VERSION 3.20)

add_executable(usb_capture
    logger.hpp
    utils.h
    utils.cpp
    win_service.h
    win_service.cpp
    sample_bus.h
    sample_bus.cpp
    thread_controller.hpp
    usb_cap.h
    usb_cap.cpp
    websocket_server.h
    websocket_server.cpp
    app.h
    app.cpp
    main.cpp)

find_package(Boost 1.70.0 REQUIRED)

set_target_properties(usb_capture PROPERTIES LINK_FLAGS
        "/MANIFESTUAC:\"level='requireAdministrator' uiAccess='false'\"")

target_compile_definitions(usb_capture PRIVATE _SILENCE_ALL_CXX17_DEPRECATION_WARNINGS _CRT_SECURE_NO_WARNINGS)
target_compile_features(usb_capture PRIVATE cxx_std_17)
target_link_directories(usb_capture PRIVATE "C:\\Users\\FlushHip\\Desktop\\USB")
target_link_libraries(usb_capture
    PRIVATE spdlog::spdlog_header_only
    Boost::headers
    Boost::disable_autolinking
    cinatra::cinatra
    prettyprint::prettyprint
    argagg::argagg
    USBCap)

install(TARGETS usb_capture
    CONFIGURATIONS Debug Release
    RUNTIME DESTINATION bin)
install(FILES "C:\\\\Users\\\\FlushHip\\\\Desktop\\\\USB\\\\USBCap.dll"
    TYPE BIN)
